# CubeCity æ–°æ‰‹å¼€å‘æŒ‡å— ğŸš€

æ¬¢è¿åŠ å…¥ CubeCity å¼€å‘å›¢é˜Ÿï¼è¿™æ˜¯ä¸€æ¬¾åŸºäº Three.js å’Œ Vue 3 çš„ 2.5D å¡é€šåŸå¸‚æ¨¡æ‹Ÿç»è¥æ¸¸æˆã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹é¡¹ç›®å¼€å‘ï¼Œæˆä¸ºä¸€åä¼˜ç§€çš„ CubeCity å¼€å‘è€…ã€‚

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆä»‹ç»](#æŠ€æœ¯æ ˆä»‹ç»)
3. [å¼€å‘ç¯å¢ƒæ­å»º](#å¼€å‘ç¯å¢ƒæ­å»º)
4. [é¡¹ç›®ç»“æ„è§£æ](#é¡¹ç›®ç»“æ„è§£æ)
5. [æ ¸å¿ƒæ¦‚å¿µç†è§£](#æ ¸å¿ƒæ¦‚å¿µç†è§£)
6. [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
7. [å¸¸è§å¼€å‘ä»»åŠ¡](#å¸¸è§å¼€å‘ä»»åŠ¡)
8. [è°ƒè¯•ä¸æµ‹è¯•](#è°ƒè¯•ä¸æµ‹è¯•)
9. [éƒ¨ç½²ä¸å‘å¸ƒ](#éƒ¨ç½²ä¸å‘å¸ƒ)
10. [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”)

---

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®ç®€ä»‹
CubeCity æ˜¯ä¸€æ¬¾ 2.5D å¡é€šé£æ ¼çš„åŸå¸‚å»ºè®¾æ¨¡æ‹Ÿæ¸¸æˆï¼Œç©å®¶é€šè¿‡æ”¾ç½®ã€ç®¡ç†å„ç±»å»ºç­‘ï¼Œç»è¥å¹¶æ‰©å±•å±äºè‡ªå·±çš„åŸå¸‚ã€‚

### æ ¸å¿ƒç‰¹æ€§
- ğŸ—ï¸ **3D åŸå¸‚å»ºè®¾**ï¼šåŸºäº Three.js çš„ 3D åœºæ™¯æ¸²æŸ“
- ğŸ® **æ¨¡æ‹Ÿç»è¥**ï¼šRCI & ESG å¤šç»´å»ºç­‘ä½“ç³»
- ğŸ’¾ **æœ¬åœ°å­˜å‚¨**ï¼šè‡ªåŠ¨ä¿å­˜æ¸¸æˆè¿›åº¦
- ğŸ“± **å“åº”å¼è®¾è®¡**ï¼šæ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- ğŸŒ **å›½é™…åŒ–**ï¼šæ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢
- ğŸ¨ **ç°ä»£åŒ– UI**ï¼šåŸºäº Vue 3 + Tailwind CSS

### å¼€å‘ç›®æ ‡
- æä¾›æµç•…çš„ 3D åŸå¸‚å»ºè®¾ä½“éªŒ
- å®ç°å¤æ‚çš„å»ºç­‘ç›¸äº’ä½œç”¨ç³»ç»Ÿ
- æ„å»ºå¯æ‰©å±•çš„æ¸¸æˆæ¶æ„
- ä¿æŒä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆä»‹ç»

### æ ¸å¿ƒæŠ€æœ¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Vue 3** | 3.x | å‰ç«¯æ¡†æ¶ï¼Œè´Ÿè´£ UI å±‚ |
| **Three.js** | 0.172.0 | 3D å›¾å½¢æ¸²æŸ“å¼•æ“ |
| **Vite** | 5.4.0 | æ„å»ºå·¥å…·å’Œå¼€å‘æœåŠ¡å™¨ |
| **Pinia** | 3.0.3 | çŠ¶æ€ç®¡ç† |
| **Tailwind CSS** | 3.4.9 | CSS æ¡†æ¶ |

### è¾…åŠ©æŠ€æœ¯
| æŠ€æœ¯ | ç”¨é€” |
|------|------|
| **GSAP** | åŠ¨ç”»åº“ï¼Œç”¨äº UI å’Œ 3D åŠ¨ç”» |
| **Cannon.js** | ç‰©ç†å¼•æ“ |
| **Mitt** | äº‹ä»¶æ€»çº¿ï¼Œç”¨äºç»„ä»¶é€šä¿¡ |
| **Vue I18n** | å›½é™…åŒ–æ”¯æŒ |
| **Tweakpane** | è°ƒè¯•é¢æ¿ |

### å¼€å‘å·¥å…·
| å·¥å…· | ç”¨é€” |
|------|------|
| **ESLint** | ä»£ç è´¨é‡æ£€æŸ¥ |
| **Prettier** | ä»£ç æ ¼å¼åŒ– |
| **Playwright** | ç«¯åˆ°ç«¯æµ‹è¯• |
| **Husky** | Git hooks |
| **Commitlint** | æäº¤ä¿¡æ¯è§„èŒƒ |

---

## ğŸš€ å¼€å‘ç¯å¢ƒæ­å»º

### 1. ç¯å¢ƒè¦æ±‚
- **Node.js**: >= 18.0.0
- **åŒ…ç®¡ç†å™¨**: pnpm (æ¨è) æˆ– npm
- **ç¼–è¾‘å™¨**: VS Code (æ¨è)
- **æµè§ˆå™¨**: Chrome/Edge (æ”¯æŒ WebGL)

### 2. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-username/CubeCity.git
cd CubeCity
```

### 3. å®‰è£…ä¾èµ–
```bash
# ä½¿ç”¨ pnpm (æ¨è)
pnpm install

# æˆ–ä½¿ç”¨ npm
npm install
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
pnpm dev
# æˆ–
npm run dev
```

è®¿é—® `http://localhost:5173` æŸ¥çœ‹é¡¹ç›®ã€‚

### 5. å…¶ä»–å¸¸ç”¨å‘½ä»¤
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬
pnpm preview

# ä»£ç æ£€æŸ¥
pnpm lint

# ä»£ç æ ¼å¼åŒ–
pnpm lint:fix

# è¿è¡Œæµ‹è¯•
pnpm test:chrome
```

---

## ğŸ“ é¡¹ç›®ç»“æ„è§£æ

```
CubeCity/
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ PRD.md              # äº§å“éœ€æ±‚æ–‡æ¡£
â”‚   â”œâ”€â”€ TD.md               # æŠ€æœ¯è®¾è®¡æ–‡æ¡£
â”‚   â””â”€â”€ æ–°æ‰‹æŒ‡å—.md         # ç©å®¶æŒ‡å—
â”œâ”€â”€ public/                  # é™æ€èµ„æº
â”‚   â”œâ”€â”€ models/             # 3D æ¨¡å‹æ–‡ä»¶
â”‚   â”œâ”€â”€ textures/           # çº¹ç†æ–‡ä»¶
â”‚   â””â”€â”€ fonts/              # å­—ä½“æ–‡ä»¶
â”œâ”€â”€ src/                     # æºä»£ç 
â”‚   â”œâ”€â”€ components/         # Vue ç»„ä»¶
â”‚   â”œâ”€â”€ js/                 # Three.js ç›¸å…³ä»£ç 
â”‚   â”‚   â”œâ”€â”€ components/     # 3D ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ tools/          # å·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ world/          # ä¸–ç•Œç®¡ç†
â”‚   â”œâ”€â”€ shaders/            # GLSL ç€è‰²å™¨
â”‚   â”œâ”€â”€ stores/             # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ assets/             # èµ„æºæ–‡ä»¶
â”‚   â””â”€â”€ css/                # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ tests/                   # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ package.json            # é¡¹ç›®é…ç½®
â””â”€â”€ vite.config.js          # Vite é…ç½®
```

### æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

#### Vue å±‚ (src/components/)
- `App.vue`: ä¸»åº”ç”¨ç»„ä»¶
- `GameCanvas.vue`: æ¸¸æˆç”»å¸ƒç»„ä»¶
- `BuildingSidebar.vue`: å»ºç­‘é€‰æ‹©é¢æ¿
- `BuildingDetail.vue`: å»ºç­‘è¯¦æƒ…é¢æ¿

#### Three.js å±‚ (src/js/)
- `experience.js`: æ ¸å¿ƒä½“éªŒç±»ï¼Œå•ä¾‹æ¨¡å¼
- `camera.js`: ç›¸æœºç®¡ç†
- `renderer.js`: æ¸²æŸ“å™¨ç®¡ç†
- `world.js`: ä¸–ç•Œç®¡ç†
- `components/`: 3D ç»„ä»¶
  - `tiles/`: åœ°çš®ç³»ç»Ÿ
  - `buildings/`: å»ºç­‘ç³»ç»Ÿ
  - `effects/`: ç‰¹æ•ˆç³»ç»Ÿ

#### çŠ¶æ€ç®¡ç† (src/stores/)
- `useGameState.js`: æ¸¸æˆçŠ¶æ€ç®¡ç†

---

## ğŸ§  æ ¸å¿ƒæ¦‚å¿µç†è§£

### 1. æ¶æ„è®¾è®¡æ¨¡å¼

#### å•ä¾‹æ¨¡å¼ (Experience)
```javascript
// src/js/experience.js
export default class Experience {
  constructor() {
    if (Experience.instance) {
      return Experience.instance
    }
    Experience.instance = this

    // åˆå§‹åŒ–æ ¸å¿ƒç»„ä»¶
    this.scene = new THREE.Scene()
    this.camera = new Camera()
    this.renderer = new Renderer()
    // ...
  }
}
```

#### ç»„ä»¶åŒ–è®¾è®¡
- **Vue ç»„ä»¶**: è´Ÿè´£ UI äº¤äº’å’ŒçŠ¶æ€å±•ç¤º
- **Three.js ç»„ä»¶**: è´Ÿè´£ 3D åœºæ™¯æ¸²æŸ“å’Œé€»è¾‘
- **çŠ¶æ€ç®¡ç†**: Pinia ç»Ÿä¸€ç®¡ç†æ¸¸æˆçŠ¶æ€

### 2. é€šä¿¡æœºåˆ¶

#### Vue â†” Three.js é€šä¿¡
```javascript
// ä½¿ç”¨ mitt äº‹ä»¶æ€»çº¿
import emitter from './utils/event-bus.js'

// Vue ç»„ä»¶å‘é€äº‹ä»¶
emitter.emit('ui:building-selected', { type: 'house' })

// Three.js ç»„ä»¶ç›‘å¬äº‹ä»¶
emitter.on('ui:building-selected', (data) => {
  // å¤„ç†å»ºç­‘é€‰æ‹©é€»è¾‘
})
```

#### çŠ¶æ€åŒæ­¥
```javascript
// ä½¿ç”¨ Pinia è¿›è¡ŒçŠ¶æ€ç®¡ç†
import { useGameState } from '@/stores/useGameState.js'

const gameState = useGameState()
gameState.setMode('build')
gameState.setSelectedBuilding({ type: 'house', level: 1 })
```

### 3. èµ„æºç®¡ç†

#### èµ„æºåŠ è½½
```javascript
// src/js/sources.js - å®šä¹‰èµ„æº
export default [
  {
    name: 'house',
    type: 'gltfModel',
    path: 'models/house_level1.glb'
  }
]

// ä½¿ç”¨èµ„æº
const houseModel = this.experience.resources.items.house
```

#### ç€è‰²å™¨ç®¡ç†
```javascript
// src/shaders/ - GLSL ç€è‰²å™¨
import fragmentShader from '@/shaders/fragment.glsl'
import vertexShader from '@/shaders/vertex.glsl'

const material = new THREE.ShaderMaterial({
  vertexShader,
  fragmentShader,
  uniforms: {
    time: { value: 0 }
  }
})
```

---

## ğŸ“ å¼€å‘è§„èŒƒ

### 1. ä»£ç é£æ ¼

#### JavaScript/TypeScript
- ä½¿ç”¨ ES6+ è¯­æ³•
- ç±»åä½¿ç”¨å¤§é©¼å³°å‘½å
- æ–¹æ³•åä½¿ç”¨å°é©¼å³°å‘½å
- å¸¸é‡ä½¿ç”¨å¤§å†™ä¸‹åˆ’çº¿
- å¿…é¡»æ·»åŠ ä¸­æ–‡æ³¨é‡Š

#### Vue ç»„ä»¶
- ç»„ä»¶åä½¿ç”¨å¤§é©¼å³°å‘½å
- æ–‡ä»¶åä¸ç»„ä»¶åä¸€è‡´
- ä½¿ç”¨ Composition API
- æ ·å¼ä½¿ç”¨ Tailwind CSS

#### Three.js ç»„ä»¶
```javascript
export default class YourComponent {
  constructor() {
    // è·å– Experience å•ä¾‹å®ä¾‹
    this.experience = new Experience()

    // è·å–éœ€è¦çš„æ ¸å¿ƒç»„ä»¶
    this.scene = this.experience.scene
    this.resources = this.experience.resources
    this.debug = this.experience.debug

    // åˆå§‹åŒ–ç»„ä»¶
    this.init()
  }

  init() {
    // ç»„ä»¶åˆå§‹åŒ–é€»è¾‘
  }

  update() {
    // æ›´æ–°é€»è¾‘
  }

  resize() {
    // å“åº”å¼è°ƒæ•´
  }
}
```

### 2. æ–‡ä»¶ç»„ç»‡

#### ç»„ä»¶æ–‡ä»¶ç»“æ„
```
src/js/components/
â”œâ”€â”€ tiles/           # åœ°çš®ç›¸å…³ç»„ä»¶
â”œâ”€â”€ buildings/       # å»ºç­‘ç›¸å…³ç»„ä»¶
â”œâ”€â”€ effects/         # ç‰¹æ•ˆç»„ä»¶
â””â”€â”€ ui/             # UI ç›¸å…³ç»„ä»¶
```

#### å·¥å…·æ–‡ä»¶ç»“æ„
```
src/js/utils/
â”œâ”€â”€ debug.js        # è°ƒè¯•å·¥å…·
â”œâ”€â”€ event-bus.js    # äº‹ä»¶æ€»çº¿
â”œâ”€â”€ resources.js    # èµ„æºç®¡ç†
â””â”€â”€ sizes.js        # å°ºå¯¸ç®¡ç†
```

### 3. å‘½åè§„èŒƒ

#### æ–‡ä»¶å‘½å
- ç»„ä»¶æ–‡ä»¶: `PascalCase.js`
- å·¥å…·æ–‡ä»¶: `kebab-case.js`
- ç€è‰²å™¨æ–‡ä»¶: `kebab-case.glsl`

#### å˜é‡å‘½å
```javascript
// å¸¸é‡
const BUILDING_TYPES = ['house', 'factory', 'shop']

// ç±»å
class BuildingFactory {}

// æ–¹æ³•å
function createBuilding() {}

// ç§æœ‰å±æ€§
this._privateProperty = value
```

### 4. æ³¨é‡Šè§„èŒƒ

#### ä¸­æ–‡æ³¨é‡Šè¦æ±‚
```javascript
/**
 * å»ºç­‘å·¥å‚ç±»
 * è´Ÿè´£åˆ›å»ºå’Œç®¡ç†ä¸åŒç±»å‹çš„å»ºç­‘å®ä¾‹
 */
export default class BuildingFactory {
  /**
   * åˆ›å»ºå»ºç­‘å®ä¾‹
   * @param {string} type - å»ºç­‘ç±»å‹
   * @param {number} level - å»ºç­‘ç­‰çº§
   * @returns {Building} å»ºç­‘å®ä¾‹
   */
  createBuilding(type, level) {
    // æ ¹æ®ç±»å‹åˆ›å»ºå¯¹åº”å»ºç­‘
    switch (type) {
      case 'house':
        return new House(level)
      case 'factory':
        return new Factory(level)
      default:
        throw new Error(`æœªçŸ¥å»ºç­‘ç±»å‹: ${type}`)
    }
  }
}
```

---

## ğŸ”§ å¸¸è§å¼€å‘ä»»åŠ¡

### 1. æ·»åŠ æ–°å»ºç­‘ç±»å‹

#### æ­¥éª¤ 1: å®šä¹‰å»ºç­‘æ•°æ®
```javascript
// src/constants/constants.js
export const BUILDING_DATA = {
  newBuilding: {
    name: { zh: 'æ–°å»ºç­‘', en: 'New Building' },
    type: 'newBuilding',
    icon: 'ğŸ¢',
    category: 'commercial',
    levels: {
      1: {
        displayName: { zh: 'åŸºç¡€æ–°å»ºç­‘', en: 'Basic New Building' },
        cost: 500,
        coinOutput: 25,
        powerUsage: 10,
        pollution: 2,
        upgradeCost: 1000,
        nextLevel: 2,
        visible: true
      }
    }
  }
}
```

#### æ­¥éª¤ 2: åˆ›å»º 3D ç»„ä»¶
```javascript
// src/js/components/buildings/new-building.js
import Building from './building.js'

export default class NewBuilding extends Building {
  constructor(level = 1) {
    super('newBuilding', level)

    // åŠ è½½æ¨¡å‹
    this.model = this.resources.items.newBuilding
    this.scene.add(this.model)
  }

  // é‡å†™ç‰¹å®šæ–¹æ³•
  getCoinOutput() {
    return this.buildingData.coinOutput * this.level
  }
}
```

#### æ­¥éª¤ 3: æ·»åŠ æ¨¡å‹èµ„æº
```javascript
// src/js/sources.js
export default [
  // ... å…¶ä»–èµ„æº
  {
    name: 'newBuilding',
    type: 'gltfModel',
    path: 'models/new-building.glb'
  }
]
```

#### æ­¥éª¤ 4: æ›´æ–° UI ç»„ä»¶
```vue
<!-- src/components/BuildingSidebar.vue -->
<template>
  <div class="building-card" @click="selectBuilding('newBuilding')">
    <div class="building-icon">
      ğŸ¢
    </div>
    <div class="building-name">
      {{ t('newBuilding.name') }}
    </div>
    <div class="building-cost">
      {{ getBuildingCost('newBuilding') }}
    </div>
  </div>
</template>
```

### 2. å®ç°å»ºç­‘ç›¸äº’ä½œç”¨

#### æ­¥éª¤ 1: å®šä¹‰ç›¸äº’ä½œç”¨è§„åˆ™
```javascript
// src/constants/building-interactions.js
export const BUILDING_INTERACTIONS = {
  house: {
    park: {
      distance: 1,
      effect: 'maxPopulation',
      multiplier: 0.1, // +10%
      description: 'ç›¸é‚»å…¬å›­å¢åŠ äººå£å®¹é‡'
    },
    factory: {
      distance: 1,
      effect: 'maxPopulation',
      multiplier: -0.15, // -15%
      description: 'ç›¸é‚»å·¥å‚å‡å°‘äººå£å®¹é‡'
    }
  }
}
```

#### æ­¥éª¤ 2: å®ç°ç›¸äº’ä½œç”¨é€»è¾‘
```javascript
// src/js/components/buildings/building.js
export default class Building {
  calculateInteractions() {
    const neighbors = this.getNeighborTiles()
    let bonus = 1.0

    neighbors.forEach((tile) => {
      if (tile.building) {
        const interaction = BUILDING_INTERACTIONS[this.type]?.[tile.building.type]
        if (interaction) {
          bonus += interaction.multiplier
        }
      }
    })

    return Math.max(0.5, bonus) // æœ€ä½ 50% æ•ˆç‡
  }
}
```

### 3. æ·»åŠ æ–°ç‰¹æ•ˆ

#### æ­¥éª¤ 1: åˆ›å»ºç€è‰²å™¨
```glsl
// src/shaders/effects/new-effect/fragment.glsl
uniform float time;
uniform vec3 color;

varying vec2 vUv;

void main() {
  vec2 uv = vUv;
  float wave = sin(uv.x * 10.0 + time) * 0.5 + 0.5;
  gl_FragColor = vec4(color * wave, 1.0);
}
```

#### æ­¥éª¤ 2: åˆ›å»ºç‰¹æ•ˆç»„ä»¶
```javascript
// src/js/components/effects/new-effect.js
import fragmentShader from '@/shaders/effects/new-effect/fragment.glsl'
import vertexShader from '@/shaders/effects/new-effect/vertex.glsl'

export default class NewEffect {
  constructor() {
    this.material = new THREE.ShaderMaterial({
      vertexShader,
      fragmentShader,
      uniforms: {
        time: { value: 0 },
        color: { value: new THREE.Color(0x00FF00) }
      },
      transparent: true
    })
  }

  update() {
    this.material.uniforms.time.value += 0.01
  }
}
```

### 4. æ·»åŠ æ–° UI åŠŸèƒ½

#### æ­¥éª¤ 1: åˆ›å»º Vue ç»„ä»¶
```vue
<!-- src/components/NewFeature.vue -->
<script setup>
import { ref } from 'vue'

const props = defineProps({
  title: {
    type: String,
    required: true
  }
})
</script>

<template>
  <div class="new-feature">
    <h3>{{ title }}</h3>
    <div class="content">
      <slot />
    </div>
  </div>
</template>

<style scoped>
.new-feature {
  @apply p-4 bg-white rounded-lg shadow-md;
}
</style>
```

#### æ­¥éª¤ 2: é›†æˆåˆ°ä¸»åº”ç”¨
```vue
<!-- src/App.vue -->
<script setup>
import NewFeature from '@/components/NewFeature.vue'
</script>

<template>
  <div id="app">
    <!-- ç°æœ‰å†…å®¹ -->
    <NewFeature title="æ–°åŠŸèƒ½" />
  </div>
</template>
```

---

## ğŸ› è°ƒè¯•ä¸æµ‹è¯•

### 1. è°ƒè¯•å·¥å…·

#### æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- **Console**: æŸ¥çœ‹æ—¥å¿—å’Œé”™è¯¯
- **Network**: æ£€æŸ¥èµ„æºåŠ è½½
- **Performance**: åˆ†ææ€§èƒ½é—®é¢˜
- **Application**: æŸ¥çœ‹æœ¬åœ°å­˜å‚¨

#### Three.js è°ƒè¯•
```javascript
// å¯ç”¨è°ƒè¯•é¢æ¿
if (this.debug.active) {
  this.debugFolder = this.debug.ui.addFolder({
    title: 'ç»„ä»¶åç§°',
    expanded: true
  })

  this.debugFolder.addBinding(this.object, 'position', {
    label: 'ä½ç½®'
  })
}
```

#### Vue DevTools
- å®‰è£… Vue DevTools æµè§ˆå™¨æ‰©å±•
- æŸ¥çœ‹ç»„ä»¶çŠ¶æ€å’Œäº‹ä»¶
- è°ƒè¯• Pinia çŠ¶æ€ç®¡ç†

### 2. æ€§èƒ½ä¼˜åŒ–

#### 3D åœºæ™¯ä¼˜åŒ–
```javascript
// ä½¿ç”¨å¯¹è±¡æ± 
class ObjectPool {
  constructor(createFn) {
    this.pool = []
    this.createFn = createFn
  }

  get() {
    return this.pool.pop() || this.createFn()
  }

  release(obj) {
    this.pool.push(obj)
  }
}

// ä½¿ç”¨ LOD (Level of Detail)
const lod = new THREE.LOD()
lod.addLevel(highDetailMesh, 0)
lod.addLevel(mediumDetailMesh, 50)
lod.addLevel(lowDetailMesh, 100)
```

#### å†…å­˜ç®¡ç†
```javascript
// æ­£ç¡®é‡Šæ”¾èµ„æº
dispose() {
  // é‡Šæ”¾å‡ ä½•ä½“
  this.geometry.dispose()

  // é‡Šæ”¾æè´¨
  this.material.dispose()

  // ä»åœºæ™¯ä¸­ç§»é™¤
  this.scene.remove(this.mesh)

  // æ¸…ç©ºçº¹ç†
  this.texture.dispose()
}
```

### 3. æµ‹è¯•

#### å•å…ƒæµ‹è¯•
```javascript
import BuildingCard from '@/components/BuildingCard.vue'
import { mount } from '@vue/test-utils'
// tests/components.test.js
import { describe, expect, it } from 'vitest'

describe('BuildingCard', () => {
  it('æ˜¾ç¤ºæ­£ç¡®çš„å»ºç­‘ä¿¡æ¯', () => {
    const wrapper = mount(BuildingCard, {
      props: {
        building: {
          name: 'ä½å®…',
          cost: 300
        }
      }
    })

    expect(wrapper.text()).toContain('ä½å®…')
    expect(wrapper.text()).toContain('300')
  })
})
```

#### ç«¯åˆ°ç«¯æµ‹è¯•
```javascript
// tests/e2e/game.test.js
import { expect, test } from '@playwright/test'

test('å»ºç­‘æ”¾ç½®åŠŸèƒ½', async ({ page }) => {
  await page.goto('/')

  // é€‰æ‹©å»ºç­‘
  await page.click('[data-testid="building-house"]')

  // ç‚¹å‡»åœ°çš®æ”¾ç½®
  await page.click('[data-testid="tile-0-0"]')

  // éªŒè¯å»ºç­‘å·²æ”¾ç½®
  await expect(page.locator('[data-testid="building-instance"]')).toBeVisible()
})
```

---

## ğŸš€ éƒ¨ç½²ä¸å‘å¸ƒ

### 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
# æ„å»º
pnpm build

# é¢„è§ˆæ„å»ºç»“æœ
pnpm preview
```

### 2. éƒ¨ç½²é…ç½®
```javascript
// vite.config.js
export default defineConfig({
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false,
    minify: 'terser',
    rollupOptions: {
      output: {
        manualChunks: {
          three: ['three'],
          vendor: ['vue', 'pinia']
        }
      }
    }
  }
})
```

### 3. æ€§èƒ½ä¼˜åŒ–
- å¯ç”¨ Gzip å‹ç¼©
- ä½¿ç”¨ CDN åŠ é€Ÿ
- é…ç½®ç¼“å­˜ç­–ç•¥
- ä¼˜åŒ–å›¾ç‰‡å’Œæ¨¡å‹èµ„æº

---

## â“ å¸¸è§é—®é¢˜è§£ç­”

### Q1: å¦‚ä½•å¿«é€Ÿç†è§£é¡¹ç›®æ¶æ„ï¼Ÿ
A: å»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºå­¦ä¹ ï¼š
1. é˜…è¯» `docs/PRD.md` äº†è§£äº§å“éœ€æ±‚
2. æŸ¥çœ‹ `docs/TD.md` ç†è§£æŠ€æœ¯è®¾è®¡
3. ä» `src/js/experience.js` å¼€å§‹ï¼Œç†è§£æ ¸å¿ƒæ¶æ„
4. æŸ¥çœ‹ `src/components/App.vue` äº†è§£ UI ç»“æ„

### Q2: å¦‚ä½•æ·»åŠ æ–°çš„å»ºç­‘ç±»å‹ï¼Ÿ
A: å‚è€ƒ [æ·»åŠ æ–°å»ºç­‘ç±»å‹](#1-æ·»åŠ æ–°å»ºç­‘ç±»å‹) ç« èŠ‚ï¼Œéœ€è¦ï¼š
1. åœ¨ `constants.js` ä¸­å®šä¹‰å»ºç­‘æ•°æ®
2. åˆ›å»ºå¯¹åº”çš„ 3D ç»„ä»¶
3. æ·»åŠ æ¨¡å‹èµ„æº
4. æ›´æ–° UI ç»„ä»¶

### Q3: å¦‚ä½•è°ƒè¯• 3D åœºæ™¯é—®é¢˜ï¼Ÿ
A: ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š
1. å¯ç”¨è°ƒè¯•é¢æ¿æŸ¥çœ‹å¯¹è±¡å±æ€§
2. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Console
3. æ£€æŸ¥ Three.js çš„ WebGL é”™è¯¯
4. ä½¿ç”¨ `console.log` è¾“å‡ºå…³é”®æ•°æ®

### Q4: å¦‚ä½•å¤„ç†æ€§èƒ½é—®é¢˜ï¼Ÿ
A: å¸¸è§ä¼˜åŒ–æ–¹æ³•ï¼š
1. ä½¿ç”¨å¯¹è±¡æ± å‡å°‘å†…å­˜åˆ†é…
2. å®ç° LOD ç³»ç»Ÿ
3. åˆç†ä½¿ç”¨çº¹ç†å‹ç¼©
4. ä¼˜åŒ–æ¸²æŸ“å¾ªç¯

### Q5: å¦‚ä½•å®ç°å›½é™…åŒ–ï¼Ÿ
A: ä½¿ç”¨ Vue I18nï¼š
1. åœ¨ `src/assets/i18n/` ä¸­æ·»åŠ è¯­è¨€æ–‡ä»¶
2. ä½¿ç”¨ `$t()` å‡½æ•°åŒ…è£…æ–‡æœ¬
3. é€šè¿‡ `useI18n()` åˆ‡æ¢è¯­è¨€

### Q6: å¦‚ä½•æäº¤ä»£ç ï¼Ÿ
A: éµå¾ªé¡¹ç›®è§„èŒƒï¼š
1. ä½¿ç”¨ `git add` æš‚å­˜æ›´æ”¹
2. ä½¿ç”¨ `git commit` æäº¤ï¼Œéµå¾ª commitizen è§„èŒƒ
3. æäº¤ä¿¡æ¯æ ¼å¼ï¼š`feat: æ·»åŠ æ–°å»ºç­‘ç±»å‹ (#issue)`

---

## ğŸ“š å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Three.js å®˜æ–¹æ–‡æ¡£](https://threejs.org/docs/)
- [Vite å®˜æ–¹æ–‡æ¡£](https://vitejs.dev/)
- [Pinia å®˜æ–¹æ–‡æ¡£](https://pinia.vuejs.org/)

### æ¨èé˜…è¯»
- [Three.js æœ€ä½³å®è·µ](https://discoverthreejs.com/)
- [Vue 3 ç»„åˆå¼ API](https://vuejs.org/guide/extras/composition-api-faq.html)
- [WebGL åŸºç¡€](https://webglfundamentals.org/)

### ç¤¾åŒºèµ„æº
- [Three.js è®ºå›](https://discourse.threejs.org/)
- [Vue.js ç¤¾åŒº](https://forum.vuejs.org/)
- [GitHub Issues](https://github.com/your-username/CubeCity/issues)

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹
1. Fork é¡¹ç›®åˆ°ä¸ªäººä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"`
4. æ¨é€åˆ°åˆ†æ”¯ï¼š`git push origin feature/new-feature`
5. åˆ›å»º Pull Request

### ä»£ç å®¡æŸ¥
- æ‰€æœ‰ä»£ç å˜æ›´éœ€è¦ç»è¿‡å®¡æŸ¥
- ç¡®ä¿ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ
- æ·»åŠ å¿…è¦çš„æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°ç›¸å…³æ–‡æ¡£

### é—®é¢˜åé¦ˆ
- ä½¿ç”¨ GitHub Issues æŠ¥å‘Š Bug
- æä¾›è¯¦ç»†çš„å¤ç°æ­¥éª¤
- åŒ…å«ç¯å¢ƒä¿¡æ¯å’Œé”™è¯¯æ—¥å¿—
- å»ºè®®è§£å†³æ–¹æ¡ˆ

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®åœ°å€**: [GitHub Repository](https://github.com/your-username/CubeCity)
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/your-username/CubeCity/issues)
- **è®¨è®ºåŒº**: [GitHub Discussions](https://github.com/your-username/CubeCity/discussions)

---

## ğŸ‰ ç»“è¯­

æ­å–œä½ å®Œæˆäº† CubeCity æ–°æ‰‹å¼€å‘æŒ‡å—çš„å­¦ä¹ ï¼ç°åœ¨ä½ å·²ç»å…·å¤‡äº†å¼€å§‹å¼€å‘çš„åŸºç¡€çŸ¥è¯†ã€‚

è®°ä½ï¼š
- ğŸ¯ **ä¿æŒå­¦ä¹ å¿ƒæ€**ï¼šæŠ€æœ¯æ ˆåœ¨ä¸æ–­å‘å±•ï¼ŒæŒç»­å­¦ä¹ æ–°çŸ¥è¯†
- ğŸ¤ **å›¢é˜Ÿåä½œ**ï¼šä¸å›¢é˜Ÿæˆå‘˜ä¿æŒè‰¯å¥½çš„æ²Ÿé€šå’Œåä½œ
- ğŸ“ **æ–‡æ¡£ä¼˜å…ˆ**ï¼šåŠæ—¶æ›´æ–°æ–‡æ¡£ï¼Œå¸®åŠ©å…¶ä»–å¼€å‘è€…
- ğŸ› **è´¨é‡ç¬¬ä¸€**ï¼šæ³¨é‡ä»£ç è´¨é‡å’Œç”¨æˆ·ä½“éªŒ
- ğŸš€ **å‹‡äºåˆ›æ–°**ï¼šåœ¨ç°æœ‰åŸºç¡€ä¸Šæå‡ºæ”¹è¿›å»ºè®®

ç¥ä½ åœ¨ CubeCity é¡¹ç›®ä¸­å¼€å‘æ„‰å¿«ï¼Œåˆ›é€ å‡ºä¼˜ç§€çš„ä½œå“ï¼ğŸŒŸ

---

*æœ€åæ›´æ–°ï¼š2024å¹´12æœˆ*
